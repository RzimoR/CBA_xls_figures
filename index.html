
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>CBA Tool</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body class="p-4">
    <div class="d-flex align-items-center mb-4">
        <img src="https://upload.wikimedia.org/wikipedia/commons/3/32/ISGAN_Logo.png" style="height: 60px; margin-right: 20px;">
        <div>
            <h3 class="mb-0">Economic Evaluation of Investment Alternatives</h3>
        </div>
    </div>

    <p class="small text-muted mb-2">Compare up to 6 alternatives</p>

    <form id="calcForm">
        
<table class="table table-bordered table-striped align-middle">
    <thead class="table-light">
        <tr>
            <th>Name</th>
            <th>CAPEX (€)</th>
            <th>OPEX (€)</th>
            <th>Benefits (€)</th>
            <th>Years</th>
            <th>Discount Rate (%)</th>
        </tr>
    </thead>
    <tbody>
<tr>
            <td><input type="text" id="name1" class="form-control" value="A.1"></td>
            <td><input type="number" id="capex1" class="form-control" step="any"></td>
            <td><input type="number" id="opex1" class="form-control" step="any"></td>
            <td><input type="number" id="benefits1" class="form-control" step="any"></td>
            <td><input type="number" id="years1" class="form-control"></td>
            <td><input type="number" id="rate1" class="form-control" step="any"></td>
        </tr>
<tr>
            <td><input type="text" id="name2" class="form-control" value="A.2"></td>
            <td><input type="number" id="capex2" class="form-control" step="any"></td>
            <td><input type="number" id="opex2" class="form-control" step="any"></td>
            <td><input type="number" id="benefits2" class="form-control" step="any"></td>
            <td><input type="number" id="years2" class="form-control"></td>
            <td><input type="number" id="rate2" class="form-control" step="any"></td>
        </tr>
<tr>
            <td><input type="text" id="name3" class="form-control" value="A.3"></td>
            <td><input type="number" id="capex3" class="form-control" step="any"></td>
            <td><input type="number" id="opex3" class="form-control" step="any"></td>
            <td><input type="number" id="benefits3" class="form-control" step="any"></td>
            <td><input type="number" id="years3" class="form-control"></td>
            <td><input type="number" id="rate3" class="form-control" step="any"></td>
        </tr>
<tr>
            <td><input type="text" id="name4" class="form-control" value="A.4"></td>
            <td><input type="number" id="capex4" class="form-control" step="any"></td>
            <td><input type="number" id="opex4" class="form-control" step="any"></td>
            <td><input type="number" id="benefits4" class="form-control" step="any"></td>
            <td><input type="number" id="years4" class="form-control"></td>
            <td><input type="number" id="rate4" class="form-control" step="any"></td>
        </tr>
<tr>
            <td><input type="text" id="name5" class="form-control" value="A.5"></td>
            <td><input type="number" id="capex5" class="form-control" step="any"></td>
            <td><input type="number" id="opex5" class="form-control" step="any"></td>
            <td><input type="number" id="benefits5" class="form-control" step="any"></td>
            <td><input type="number" id="years5" class="form-control"></td>
            <td><input type="number" id="rate5" class="form-control" step="any"></td>
        </tr>
<tr>
            <td><input type="text" id="name6" class="form-control" value="A.6"></td>
            <td><input type="number" id="capex6" class="form-control" step="any"></td>
            <td><input type="number" id="opex6" class="form-control" step="any"></td>
            <td><input type="number" id="benefits6" class="form-control" step="any"></td>
            <td><input type="number" id="years6" class="form-control"></td>
            <td><input type="number" id="rate6" class="form-control" step="any"></td>
        </tr>
</tbody></table>
        <button type="submit" class="btn btn-primary mt-3">Calculate CBA</button>
    </form>

    <div id="results" class="mt-5"></div>
    <button class="btn btn-success mt-3" onclick="downloadExcel()">Download Excel</button>

    <script>
    function downloadExcel() {
        const table = document.querySelector(".results-table");
        if (!table) return alert("No results to export.");
        const wb = XLSX.utils.table_to_book(table, { sheet: "CBA Results" });
        XLSX.writeFile(wb, "CBA results.xlsx");
    }
    </script>
</body>
</html>
